\documentclass[12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath, graphicx, float, hyperref, cite, pgfplots}

\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\MyIm}{Im}

\graphicspath{{./pictures/}}

\hypersetup{
    colorlinks=true,
    linkcolor=red,
    urlcolor=blue,
    citecolor=orange,
}

\begin{document}
    \begin{titlepage}
        \begin{center}
            \vspace*{1cm}

            \Huge
            \textbf{Закон всемирного тяготения.\\Точки Лагранжа}

            \vspace{1.5cm}

            \Large
            \textbf{Балдин Виктор Б01-303}

            \vfill

            Вопрос по выбору \\
            Устный экзамен по общей физике

            \vspace{0.8cm}

            \includegraphics[width=0.4\textwidth]{university_logo.png}

            Физтех-школа радиотехники и компьютерных технологий\\
            Московский физико-технический институт\\
            Долгопрудный, 2024
        \end{center}
    \end{titlepage}

    \begin{abstract}
        \par Данный вопрос по выбору включает в себя теоретические расчеты
        положения точек Лагранжа и обсуждение некоторых их интересных
        свойств. В работе используются материалы из различных открытых
        источников об истории исследований на эту тему и современном их
        состоянии.
        \par Точки Лагранжа являются крайне важным объектом для изучения
        космического пространства в современной астрофизике.
        В частности, прямым образом их свойства используются для размещения
        космических аппаратов, предназначенных для наблюдений дальнего
        космоса.
        \par Автор выражает надежду, что данная работа содержит
        актуальные сведения и благодарит экзаменационную комиссию за ее
        рассмотрение.
    \end{abstract}

    \newpage

    \section{Введение}
    \par \textit{Точки Лагранжа}, в некоторых источниках также \textit{точки
    либрации} или \textit{$L$-точки} -- точки в системе двух тел, в которых
    третье тело может оставаться неподвижным относительно первых двух.
    \par Точки Лагранжа названы в честь математика Жозефа Луи Лагранжа,
    который первым в 1772 году показал их существование.

    \begin{figure}[H]
        \centering
        \includegraphics[scale=0.35]{Lagrange_points.pdf}
        \caption{5 точек Лагранжа и гравитационные эквипотенциальные
        поверхности системы двух тел\\
        \textit{Источник:}
        \url{https://upload.wikimedia.org/wikipedia/commons/thumb/e/ee/
        Lagrange_points2.svg/1920px-Lagrange_points2.svg.png}}
        \label{points}
    \end{figure}

    \section{Точки Лагранжа}
    \par Для начала проведем краткое рассмотрение движения 3-х тел, связанных между
    собой гравитационными взаимодействиями. Это может быть описано в общем
    случае следующими дифференциальными уравнениями \cite{mit2008}:

    \begin{equation}
        \begin{cases}
            \ddot{\vec{r_1}} = -Gm_2\frac{\vec{r_1} - \vec{r_2}}
            {\lvert \vec{r_1} - \vec{r_2} \rvert} -
            Gm_3\frac{\vec{r_1} - \vec{r_3}}{\lvert \vec{r_1} - 
            \vec{r_3} \rvert}\\
            \ddot{\vec{r_2}} = -Gm_2\frac{\vec{r_2} - \vec{r_3}}
            {\lvert \vec{r_2} - \vec{r_3} \rvert} -
            Gm_3\frac{\vec{r_2} - \vec{r_1}}{\lvert \vec{r_2} - 
            \vec{r_1} \rvert}\\
            \ddot{\vec{r_3}} = -Gm_2\frac{\vec{r_3} - \vec{r_1}}
            {\lvert \vec{r_3} - \vec{r_1} \rvert} -
            Gm_3\frac{\vec{r_3} - \vec{r_2}}{\lvert \vec{r_3} - 
            \vec{r_2} \rvert}\\
        \end{cases}\,.
    \end{equation}

    Данная система имеет множество сложных решений, на которых мы не будем
    останавливаться. В нашу задачу входит частный случай задачи трех тел 
    (англ. \textit{restricted three-body problem}), в котором имеем
    2 массивных тела массами $M_1$ и $M_2$ и третье тело массой $m$, 
    $m \ll M_1$, $m \ll M_2$. В таком случае мы можем рассматривать движение
    $M_1$ и $M_2$ в рамках задачи двух тел, пренебрегая гравитационным
    воздействием третьего тела.
    \par Как известно, два тела в отсутствии внешних гравитационных воздейстсвий
    вращаются относительно центра масс системы. Мы будем рассматривать случай,
    когда они вращаются по окружности. Поэтому теперь мы можем
    поставить задачу конкретнее: найти все возможные положения третьего тела,
    при которых оно будет совершать вращение вокруг центра масс с той же угловой
    скоростью, что и $M_1$ и $M_2$. Логично ввести систему координат с началом в
    центре масс системы. Обозначим радиус-векторы $M_1$ и $M_2$ через $\vec{r_1}$
    и $\vec{r_2}$ соответственно.

    \begin{figure}[H]
        \centering
        \includegraphics[scale = 2]{two-bodies.png}
        \caption{Рассматриваемый частный случай задачи трех тел \cite{nasagov}}
    \end{figure}

    Понятно, что теперь мы можем написать уравнение для ускорения тела $m$, 
    исходя из второго закона Ньютона и закона всемирного тяготения:
    
    \begin{equation}
        \vec{a} = \ddot{\vec{r}} = -\frac{GM_1}{\lvert \vec{r} - \vec{r_1} \rvert^3}
        (\vec{r} - \vec{r_1}) - \frac{GM_2}{\lvert \vec{r} - \vec{r_2} \rvert^3}
        (\vec{r} - \vec{r_2}) 
        \label{acceleration}
    \end{equation}

    \par Теперь из третьего закона Кеплера \cite{sivykhin} найдем угловую 
    скорость вращения системы $M_1$ и $M_2$:

    \begin{equation}
        \Omega^2 R^3 = G(M_1 + M_2), 
        \label{kepler}
    \end{equation}

    где $R$ -- расстояние между телами. Здесь используется, что $M_1$ и $M_2$ вращаются
    по окружностям радиусов $r_1$ и $r_2$ соответственно.

    \par Введем обозначения:
    \begin{equation}
        \alpha = \frac{M_2}{M_1 + M_2},\\\ \beta = \frac{M_1}{M_1 + M_2}
        \label{alpha_delta}
    \end{equation}

    \par Для дальнейших рассуждений полезно ввести ортонормированный
    базис: $\vec{k} = \frac{\vec{\Omega}}{\lvert \vec{\Omega} \rvert}$, 
    $\vec{i} = \frac{\vec{r_2}}{\lvert \vec{r_2} \rvert}$, $\vec{j} =
    [ \vec{k}, \vec{i} ]$. В этом базисе:

    % TODO: picture.
    \begin{eqnarray*}
        \vec{r}   = x(t)\vec{i} + y(t)\vec{j}\\
        \vec{r_1} = -\alpha R\vec{i}\\
        \vec{r_2} = \beta R\vec{i}
    \end{eqnarray*}

    Теперь напишем ускорение тела в системе отсчета, свзянной с $M_1$ и $M_2$.
    
    \begin{equation}
        \vec{a}_{\Omega} = \vec{a} - 2[\vec{\Omega}, \dot{\vec{r}}] - 
                            [\vec{\Omega}, [\vec{\Omega}, \vec{r}]]
        \label{a_omega}
    \end{equation}

    Так как мы ищем решения, для которых $\dot{\vec{r}} = 0$, это
    позволяет нам избавиться от ускорения Кориолиса. Таким образом, подставив 
    $\vec{a}$ из \ref{acceleration} в формулу \ref{a_omega} и заменив
    комбинации вида $GM$ через \ref{kepler}, получим:

    \begin{equation}
        \vec{a}_{\Omega} = \Omega^2
        \begin{pmatrix}
            x - \frac{\beta (x + \alpha R)R^3}{((x + \alpha R)^2 + y^2)^{3/2}} - 
            \frac{\alpha (x - \beta R)R^3}{((x - \beta R)^2 + y^2)^{3/2}} \\
            y - \frac{\beta y R^3}{((x + \alpha R)^2 + y^2)^{3/2}} - 
            \frac{\alpha y R^3}{((x - \beta R)^2 + y^2)^{3/2}}
        \end{pmatrix}
        \label{main}
    \end{equation}

    \par Так как точки Лагранжа являются точками, в которых тело $m$ может пребывать в 
    состоянии равновесия в данной вращающейся системе отсчета, все возможные решения
    $(x,y)$ поставленной задачи можно найти из уравнения $\vec{a}_{\Omega} = 0$.

    \par Получаем систему из двух уравнений. Несложно заметить, что равненство
    нулю компоненты по оси $y$ ветвится на 2 случая. 
    
    \subsection{L1, L2, L3}
    Для начала рассмотрим 
    случай $y = 0$. Чтобы немного упростить уравнение, 
    целесообразно сделать замену $x = R(u + \beta)$. В самом деле, так как
    из \ref{alpha_delta} $\alpha + \beta = 1$, получаем $x + \alpha R = (u + 1)R$,
    $x - \beta R = uR$. 
    
    \par Теперь подставим $y$ в первое уравнение системы. Для краткости
    введем обозначения $s_0 = \sign(u)$, $s_1 = \sign(u + 1)$ (они получатся
    при раскрытии знаменателей). После преобразований получим следующее уравнение:

    \begin{equation}
        u^5 + (3 - \alpha)u^4 + (3 - 2\alpha)u^3 + ((1-\alpha)(1 - s_1) - 
        \alpha s_0)u^2 - 2\alpha s_0 u - \alpha s_0 = 0
        \label{fifth}
    \end{equation}

    \par Заметим, что пара $(s_0, s_1)$ может принимать одно из значений:
    $(-1, 1)$ (между $M_1$ и $M_2$), $(1, 1)$ (за $M_2$) и $(-1, -1)$ (за $M_1$). 
    Так как уравнение \ref{fifth} пятой степени,
    для него по теореме Абеля -- Руффини \cite{alexeev} не существует общего аналитического решения
    через $\alpha$. 

    \par Поэтому мы будем решать получившиеся уравнения численными методами. Для
    этого воспользуемся средствами библиотеки \href{https://numpy.org}{NumPy},
    предоставляющей программную    
    \href{https://numpy.org/doc/stable/reference/generated/numpy.roots.html#r01a8f58ef25b-1}
    {имплементацию}
    численного метода для решения
    полиномиальных уравнений произвольных порядков для языка Python3.
    При помощи данного несложного 
    \href{https://github.com/victorbaldin56/VPV/blob/main/2023/lagrange_solver/lagrange_solver.py}
    {скрипта} получим набор данных в виде таблицы, доступной по
    \href{https://github.com/victorbaldin56/VPV/blob/main/2023/lagrange_solver/lagrange_solver_data.csv}
    {ссылке}. До $\alpha = 0.01$ идем с шагом $10^{-4}$, потом $10^{-3}$.

    \par Построим графики $x/R(\alpha)$ для $L_1, L_2, L_3$ (см. рисунок \ref{sss}). 
    Отметим, что картина абсолютно симметрична относительно прямой $\alpha = 0{,}5$.

    \par Отдельный интерес так же представляют аппроксимации полученных 
    зависимостей для $\alpha \ll 1$. Их можно получить по набору точек, близких к 
    0. Источники \cite{mit2008} и \cite{nasagov} предлагают следующие приближенные решения
    для $\alpha \ll 1$:
    
    \begin{eqnarray}
        L_1\left(R\left(1 - \left(\frac{\alpha}{3}\right)^{1/3}\right), 0\right),\nonumber \\
        L_2\left(R\left(1 + \left(\frac{\alpha}{3}\right)^{1/3}\right), 0\right),\nonumber \\
        L_3\left(-R\left(1 + \frac{5}{12}\alpha\right), 0\right).
        \label{approx}
    \end{eqnarray}
     
    \begin{figure}[H]
        \centering
        \input{lagrange_solver/plots/all.pgf}
        \caption{Графики положения точек первых трех точек Лагранжа в зависимости от 
        $\alpha$}
        \label{sss}
    \end{figure}
    
    \par Построим графики с аппроксимациями (см. рисунок \ref{subplots}). Уже на этом
    этапе видно, для малых $\alpha$ (а в случае $L_3$ -- и для соизмеримых с 1) формулы
    \ref{approx} действительно дают неплохое приближение. Чтобы убедиться в этом, можно
    построить графики относительной ошибки $\varepsilon(\alpha)$ для каждой точки
    Лагранжа. Графики представлены на рисунке \ref{errors}. 

    \begin{figure}[H]
        \centering
        \input{lagrange_solver/plots/subplots.pgf}
        \caption{Графики для $L_1$, $L_2$, $L_3$ с аппроксимациями \ref{approx}}
        \label{subplots}
    \end{figure}

    \begin{figure}[H]
        \centering
        \input{lagrange_solver/plots/errors.pgf}
        \caption{Графики относительной ошибки аппроксимации \ref{approx} для $L_1$,
        $L_2$, $L_3$}
        \label{errors}
    \end{figure}

    \par По порядкам ошибок видно, что если для $L_1$ и $L_2$ аппроксимация по формулам 
    \ref{approx} дает хорошую точность лишь для очень малых значений $\alpha$,
    при $\alpha \sim 10^{-2}$ их уже можно применять лишь для совсем грубой оценки.
    Однако наличие корреляции отрицать все же нельзя.

    \par С другой стороны, для $L_3$ аппроксимация неожиданно оказывается достаточно 
    хороша, что, впрочем, неплохо видно на графике \ref{subplots}. Поэтому
    построим расширенный график для точности, взяв диапазон $(0, 0{,}2)$. Этот
    график показан рисунке \ref{errors_all}.

    \begin{figure}[]
        \centering
        \input{lagrange_solver/plots/errors_all.pgf}
        \caption{Сравнение ошибок аппроксимации для $L_1$, $L_2$, $L_3$ на промежутке
        $(0, 0{,}2)$}
        \label{errors_all}
    \end{figure}

    Как видно из графика, ошибка для $L_3$ пренебрежимо мала на фоне ошибок вычисления 
    $L_1$ и $L_2$ даже при $\alpha = 0{,}2$, тогда как аппроксимации для $L_1$ и 
    $L_2$ уже становятся крайне сомнительными при этом значении.
    
    \par Из всех вычислений можно сделать предварительный вывод, что проще всего расчету
    поддается $L_3$. Однако в случае очень малого значения $\alpha$ (как, например,
    в системе Солце -- Земля) точность формул \ref{approx} можно считать досточной.
    Для системы Земля -- Луна все уже несколько сложнее, $\alpha = 0{,}012$, так что 
    мы теоретически получим ошибки $\varepsilon_1 = 4\cdot10^{-3}$, 
    $\varepsilon_2 = 3\cdot10^{-3}$, $\varepsilon_3 = 10^{-7}$ 
    для $L_1$, $L_2$, $L_3$ соответственно. При этом конечно нужно учитывать, что
    это лишь модель, и в реальности необходимо учесть еще и тяготение Солнца
    и, возможно, планет-гигантов. Так что здесь, вероятно, необходимы весьма
    существовенные поправки, с этим связанные.

    \subsection{L4, L5}
    Вернемся теперь к уравнению \ref{main} и вспомним про случай $y \neq 0$.
    Мы не будем решать уравнение напрямую. Вместо этого учтем, что результирующая сила,
    направленная к центру масс равна нулю, а так же равна нулю и перпендикулярная ей 
    компонента, с надеждой на то, что это приведет к более простым уравнениям.
    Ортогональную компоненту вектора $\vec{a_{\Omega}}$ относительно
    вектора $\vec{r}$ можно найти как:
    
    \begin{equation}
        a_{\Omega}^{\perp} = \frac{\lvert[\vec{a}_{\Omega}, \vec{r}]\rvert}{r}
    \end{equation}

    Путем преобразований получаем следующее:

    \begin{equation}
        a_{\Omega}^{\perp} = \frac{\alpha\beta y\Omega^2R^4}{\sqrt{x^2 + y^2}}
        \left(\frac{1}{((x - \beta R)^2 + y^2)^{3/2}} - 
        \frac{1}{((x + \alpha R)^2 + y^2)^{3/2}}\right)
        \label{perp}
    \end{equation}

    Из условия $a_{\Omega}^{\perp} = 0$ получаем, что точка равновесия
    равноудалена от массивных тел. Это условие позволяет нам получить 
    упрощенное выражение для проекции:

    \begin{equation}
        a_{\Omega}^{\parallel} = \frac{\lvert (\vec{a}_{\Omega}, \vec{r}) \rvert}
        {r} = \Omega^2R^3\sqrt{x^2 + y^2}\left(\frac{1}{R^3} - \frac{1}
        {((x - \beta R)^2 + y^2)^{3/2}}\right)
        \label{parallel}
    \end{equation}

    Из \ref{perp} и \ref{parallel} получаем 2 точки, симметричные относительно
    оси $x$:

    \begin{eqnarray}
        L_4\left(\frac{R}{2}(1 - 2\alpha), \frac{\sqrt{3}}{2}R\right),\nonumber\\
        L_5\left(\frac{R}{2}(1 - 2\alpha), -\frac{\sqrt{3}}{2}R\right)
    \end{eqnarray}

    \section{Анализ устойчивости равновесия}
    

    \bibliography{references}
    \bibliographystyle{plain}

\end{document}
